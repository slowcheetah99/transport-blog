<%- include('./mapbox__head') %>
<body>
      <div id='map'></div>
            <script defer>
                const mapToken="<%=mapToken%>"
                const token=mapToken;
                //setting up the map position
                const dataLocate=(position)=>{
                    console.log(position);
                    setupMap([position.coords.longitude, position.coords.latitude]);
                    }
                //default position on error
                const errLocate=()=>{
                    setupMap([36.8219,1.2921]);
                }
                //location prompt and getting current location
                navigator.geolocation.getCurrentPosition(dataLocate, errLocate,{enableHighAccuracy: true});

                //setting up the map
                const setupMap=(center)=>{
                    mapboxgl.accessToken = token;

                    //generating the map
                    const map = new mapboxgl.Map({
                    container: 'map',
                    style: 'mapbox://styles/mapbox/streets-v11',
                    center: center,
                    zoom: 21,
                    });
                //setting up the navigation control
                  const nav=new mapboxgl.NavigationControl();
                  map.addControl(nav); 

                    //setting up the directions control
                  var directions = new MapboxDirections({
                    accessToken: token,
                    });
                    map.addControl(directions, 'top-left');   
                }
            </script>

</body>